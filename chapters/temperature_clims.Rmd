# Sea Surface Climatologies

**Description**: Comparison of temperature data with varying climatologies

**Found in**: 

**Indicator category**: 

**Contributor(s)**: Kim Bastille, Vince Saba, Hubert du Pontavice, Kim Hyde
  
**Data steward**: Kim Bastille
  
**Point of contact**: Kim Bastille
  
**Public availability statement**: 

## Impact Summary

Definiton of baseline climatology. pros and cons of shifting  

### Plotting

#### Sea Surface Temperatures 

```{r}
gom<-readxl::read_excel(here::here("data-raw/GOM_SST_1982_to_2021 - Vincent Saba - NOAA Federal.xlsx")) %>%
  dplyr::mutate(t = as.Date(t), 
                EPU = "GOM")
gb<-readxl::read_excel(here::here("data-raw/GB_SST_1982_to_2021 - Vincent Saba - NOAA Federal.xlsx")) %>%
  dplyr::mutate(t = as.Date(t), 
                EPU = "GB")
mab<-readxl::read_excel(here::here("data-raw/MAB_SST_1982_to_2021 - Vincent Saba - NOAA Federal.xlsx")) %>%
  dplyr::mutate(t = as.Date(t), 
                EPU = "MAB")

ltm8211<- rbind(gom,gb,mab) %>% 
  dplyr::mutate(Time = lubridate::year(t), 
                DOY = lubridate::yday(t)) %>% 
  dplyr::filter(Time %in% 1982:2011) %>% 
  dplyr::group_by(DOY, EPU) %>% 
  dplyr::summarise(ltm = mean(temp)) %>% 
  dplyr::mutate(Cat = "ltm 82-11")

ltm9120<- rbind(gom,gb,mab) %>% 
  dplyr::mutate(Time = lubridate::year(t), 
                DOY = lubridate::yday(t)) %>% 
  dplyr::filter(Time %in% 1991:2020) %>% 
  dplyr::group_by(DOY, EPU) %>% 
  dplyr::summarise(ltm = mean(temp)) %>% 
  dplyr::mutate(Cat = "ltm 91-20")

gom %>% rbind(gb,mab) %>% 
  dplyr::mutate(Time = lubridate::year(t), 
                DOY = lubridate::yday(t)) %>% 
  dplyr::filter(Time == 2021) %>%
  dplyr::mutate(Cat = "2021", 
                ltm = temp) %>% 
  dplyr::select(DOY, EPU, ltm, Cat) %>% 
  rbind(ltm8211, ltm9120) %>% 
  ggplot(aes(x = DOY, y = ltm, color = Cat))+
  geom_line()+
  geom_point()+
  facet_wrap(EPU~.)+
  theme(legend.title = element_blank())+
  ylab("Temp C")

```


#### Seasonal Sea Surface Temperature Anomolies 

```{r}

new<- read.csv(here::here("data-raw/SST_ltm9220.csv")) %>% 
  #dplyr::filter(EPU == "MAB") %>% 
  dplyr::mutate(ltm = c("91-20")) %>% 
  dplyr::select(-X)
ecodata::seasonal_oisst_anom %>%
  dplyr::mutate(ltm = c("82-10")) %>% 
  #dplyr::filter(EPU  == "MAB") %>%
  rbind(new) %>% 
  tidyr::separate(Var, into = c("Var", "OI","SST", "anom")) %>% 
  dplyr::mutate(Var = recode(Var, "winter" = "Winter"), 
         Var = recode(Var, "spring" = "Spring"),
         Var = recode(Var, "summer" = "Summer"),
         Var = recode(Var, "fall" = "Fall")) %>% 
  ggplot(aes(x= Time, y = Value, color = ltm))+
  geom_point()+
  geom_line()+
  ecodata::geom_gls()+
  facet_grid(EPU~Var)+
  ecodata::theme_facet() +
  ggplot2::theme(strip.text=element_text(hjust=0),
                 plot.title = element_text(size = 12))+
  ecodata::theme_title()
```

#### GOM Marine Heatwave 2021 - 82-11


```{r, fig.cap="GOM heatwave presented in the 2022 SOE, uses clim of 82-11"}
ecodata::heatwave_year %>% 
  filter(EPU == "GOM", 
         str_detect(t, "2021")) %>% 
  ggplot( aes(x = t, y = temp))+
  geom_flame(aes(y2 = thresh))+ 
  geom_line(aes(x = t, y = seas, color = "a"), size = 1)+
  geom_line(aes(x = t, y = thresh, color = "c"), size = 1)+
  geom_line(aes(x = t, y = temp, color = "b"))+
  scale_colour_manual(values = c("turquoise4", "sienna3", "black"),
                      labels = c("Climatology","Temperature", "Threshold"))+
  ylab("Temperature (C)")+
  xlab(element_blank())+
  scale_x_date(date_labels = "%b", breaks = "1 month")+
  theme_bw()+
  theme(legend.title = element_blank(),
        legend.position=c(0.2, 0.8))+
  ecodata::theme_title()



```

#### GOM Marine Heatwave 2021 -  92-20

```{r, fig.cap="GOM heatwave using climatology from 92-20"}

```


